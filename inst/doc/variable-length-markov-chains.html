<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Variable length Markov chains (VLMC)</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Variable length Markov chains (VLMC)</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(mixvlmc)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(geodist) <span class="do">## used in the earth quake example</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="do">## used in the earth quake example</span></span></code></pre></div>
<p>A <a href="https://en.wikipedia.org/wiki/Markov_chain">Markov
chain</a> is a probabilistic model for time series in which the
probability of the next state depends only on finite memory of previous
states (including the current state). The most common case is the
<em>order one</em> Markov chain, in which the memory is limited to the
current state.</p>
<p>We consider here only Markov chains with finite state spaces.</p>
<div id="theoretical-aspects" class="section level2">
<h2>Theoretical aspects</h2>
<div id="high-order-markov-chains" class="section level3">
<h3>High order Markov chains</h3>
<p>Let us denote <span class="math inline">\(X_1, X_2, \ldots, X_n,
\ldots\)</span> a sequence of random variables. It is a (stationary)
Markov chain of order <span class="math inline">\(m\)</span> is for all
<span class="math inline">\(n&gt;m\)</span> <span class="math display">\[
\begin{multline}
\mathbb{P}(X_n=x_n|X_{n-1}=x_{n-1}, X_{n-2}=x_{n-2}, \ldots,
X_{1}=x_{1})=\\
\mathbb{P}(X_n=x_n|X_{n-1}=x_{n-1}, X_{n-2}=x_{n-2}, \ldots,
X_{n-m}=x_{n-m}).
\end{multline}
\]</span> To specify such a Markov chain of order <span class="math inline">\(m\)</span>, one needs to describe the conditional
distribution on the right hand side of the previous equation for all
values of the past, i.e. for all contexts (see
<code>vignette(&quot;context-trees&quot;)</code>).</p>
<p>For a state space with <span class="math inline">\(k\)</span> states,
we need <span class="math inline">\(k-1\)</span> parameters to specify
completely <span class="math display">\[
\mathbb{P}(X_n=x_n|X_{n-1}=x_{n-1}, X_{n-2}=x_{n-2}, \ldots,
X_{n-m}=x_{n-m})
\]</span> for all values of <span class="math inline">\(x_n\)</span> and
for <em>a single</em> context <span class="math inline">\((x_{n-1},
x_{n-2}, \ldots, x_{n-m})\)</span>.<br />
There are <span class="math inline">\(k^{m-1}\)</span> such contexts and
thus we need a total of <span class="math inline">\((k-1)k^{m-1}\)</span> parameters to specify
completely a Markov chain of order <span class="math inline">\(m\)</span> on a state space with <span class="math inline">\(k\)</span> states.</p>
<p>Unfortunately, the exponential growth with respect to the order makes
high order Markov chain unrealistic on a statistical point of view: the
number of parameters to estimate grows too quickly compared to the
typical length of a time series.</p>
<p>If we consider a <a href="https://en.wikipedia.org/wiki/Gene">gene</a> as a sequence of
(pair of) bases, we have a state space with <span class="math inline">\(k=4\)</span> states. The mean protein-coding
length for <a href="https://en.wikipedia.org/wiki/Human_genome">humans</a> is roughly
66,000 (pairs of) bases. The following table shows the growth of the
parameter number for <span class="math inline">\(k=4\)</span> with the
order of a Markov chain. There are already way too many parameter with
<span class="math inline">\(m=7\)</span> for a proper estimation based
on a single gene of an average length. Even the longest genes would be
insufficient for <span class="math inline">\(m=10\)</span>.</p>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">m</th>
<th align="right">parameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">192</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">768</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">3072</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">12288</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">49152</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">196608</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">786432</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">3145728</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sparse-models" class="section level3">
<h3>Sparse models</h3>
<p>While higher order Markov chains would be very useful to capture long
memory in time series, the exponential growth of their parameter space
is incompatible with this goal. Variable length Markov chains provide a
compromise between the controlled number of parameters of low order
Markov chains and the long memory of high order ones. The key idea is to
consider that the dependency order can depend on the context itself.</p>
<p>Let us consider a simple example with a binary valued time series
(<span class="math inline">\(k=2\)</span>) and a Markov chain of order
3. We need to specify for instance the probability of <span class="math inline">\(X_n=1\)</span> given the eight possible contexts,
from <span class="math inline">\((0, 0, 0)\)</span> to <span class="math inline">\((1, 1, 1)\)</span>. A possible choice is</p>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">Probablity</th>
<th align="right">n-1</th>
<th align="right">n-2</th>
<th align="right">n-3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.4</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<p>In this table, several contexts share the same conditional
probability distribution. For instance <span class="math display">\[
\mathbb{P}(X_n=1|X_{n-1}=0,
X_{n-2}=0,X_{n-3}=0)=\mathbb{P}(X_n=1|X_{n-1}=0, X_{n-2}=1,X_{n-3}=0).
\]</span></p>
<p>In fact, a careful look at the table shows that <span class="math display">\[
\begin{align*}
\mathbb{P}(X_n=1|X_{n-1}=0, X_{n-2}=a, X_{n-3}=b)&amp;=0.1&amp;\forall
a, \forall b,\\
\mathbb{P}(X_n=1|X_{n-1}=1, X_{n-2}=1, X_{n-3}=c)&amp;=0.3&amp;\forall
c,\\
\mathbb{P}(X_n=1|X_{n-1}=1, X_{n-2}=0, X_{n-3}=0)&amp;=0.2,&amp;\\
\mathbb{P}(X_n=1|X_{n-1}=1, X_{n-2}=0, X_{n-3}=1)&amp;=0.4,
\end{align*}
\]</span> and thus the Markov chain can be described by only 4
probability distributions rather than 8. The corresponding contexts
are:</p>
<ul>
<li><span class="math inline">\((0)\)</span> : short memory only when
the last state is 0</li>
<li><span class="math inline">\((1, 1)\)</span> : second order memory
when the two last states are 1</li>
<li><span class="math inline">\((1, 0, 0)\)</span> and <span class="math inline">\((1, 0, 1)\)</span> : full third order memory</li>
</ul>
<p>This third order Markov chain is parsimonious in the sense that it
can be described by the four contexts and their associated probability
distributions rather than by the full collection needed for an arbitrary
third order Markov chain.</p>
</div>
<div id="variable-length-markov-chain" class="section level3">
<h3>Variable length Markov chain</h3>
<p>A variable length Markov chain (VLMC) is a sparse high order Markov
chain. Let us denote <span class="math inline">\(X_1, X_2, \ldots, X_n,
\ldots\)</span> a sequence of random variables taking values in the
finite state space <span class="math inline">\(S\)</span>. The sequence
is a VLMC if there is a maximal order <span class="math inline">\(l_{\max}\)</span> and a function <span class="math inline">\(l\)</span> from <span class="math inline">\(S^{l_{\max}}\)</span> to <span class="math inline">\(\{0,\ldots,l_{\max}\}\)</span> such that for all
<span class="math inline">\(n&gt;l_{\max}\)</span> <span class="math display">\[
\begin{multline}
\mathbb{P}(X_n=x_n|X_{n-1}=x_{n-1}, X_{n-2}=x_{n-2}, \ldots,
X_{1}=x_{1})=\\
\mathbb{P}(X_n=x_n|X_{n-1}=x_{n-1}, X_{n-2}=x_{n-2}, \ldots,
X_{n-l(x_{n-1},\ldots,x_{n-l_{\max}})}=x_{n-l(x_{n-1},\ldots,x_{n-l_{\max}})}).
\end{multline}
\]</span> In other words, the memory length (the order) is
<em>variable</em> and given by <span class="math inline">\(l(x_{n-1},\ldots,x_{n-l_{\max}})\)</span>.</p>
<p>The memory length function generates a <em>context</em> function
<span class="math inline">\(c\)</span> which keeps in the past the part
needed to obtain the conditional distribution: <span class="math inline">\(c\)</span> is a function from <span class="math inline">\(S^{l_{\max}}\)</span> to <span class="math inline">\(\bigcup_{k=0}^{l_{\max}}S^k\)</span> given by:
<span class="math display">\[
c(x_1, x_2, \ldots, x_{l_{\max}})=(x_1,\ldots,x_{l(x_1, x_2, \ldots,
x_{l_{\max}})})
\]</span> The image by <span class="math inline">\(c\)</span> of <span class="math inline">\(S^{l_{\max}}\)</span> is the set of contexts of
the VLMC which is entirely specified by <span class="math inline">\(l\)</span> and one conditional distribution by
unique context.</p>
<p>In the above example, <span class="math inline">\(l_{\max}=3\)</span>
and <span class="math inline">\(l\)</span> is defined from <span class="math inline">\(\{0, 1\}^3\)</span> to <span class="math inline">\(\{0, 1, 2, 3\}\)</span> by <span class="math display">\[
\begin{align*}
l(0, a, b)&amp;=1&amp;\forall a, \forall b,\\
l(1, 1, c)&amp;=2&amp;\forall c,\\
l(1, 0, 0)&amp;=3,&amp;\\
l(1, 0, 1)&amp;=3.&amp;\\
\end{align*}
\]</span></p>
</div>
<div id="vlmc-estimation" class="section level3">
<h3>VLMC estimation</h3>
<p>If we assume that an observed time series has been generated by a
VLMC, we can try and estimate from it the <span class="math inline">\(l\)</span> function and the corresponding
conditional probabilities. This is a non-parametric estimation problem
as <span class="math inline">\(l_{\max}\)</span> is unknown. A natural
way to carry on the estimation is to use some form of penalized
likelihood approach.</p>
<p>This is done by first extracting from the time series its context
tree (see <code>vignette(&quot;context-trees&quot;)</code>), a sparse
representation of all the sub-sequences (i.e. contexts) that appear at
least a few times in the time series. Each unique sub-sequence/context
is followed by a state in the time series: this is used to estimate the
conditional probabilities (from frequencies). Finally a pruning
algorithm is applied to balance the complexity of the tree with its
likelihood (given the time series).</p>
</div>
</div>
<div id="vlmc-in-practice" class="section level2">
<h2>VLMC in practice</h2>
<div id="estimation" class="section level3">
<h3>Estimation</h3>
<p>VLMC estimation is provided by the <code>vlmc()</code> function as in
the following example.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(0L, 1L, 2L), <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">vlmc</span>(x)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>model</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; VLMC context tree on 0, 1, 2 </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;  cutoff: 2.996 (quantile: 0.05)</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;  Number of contexts: 4 </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;  Maximum context length: 3</span></span></code></pre></div>
<p>The estimation process is controlled by three parameters:</p>
<ul>
<li><code>max_depth</code>: the largest order/memory considered for the
VLMC (defaults to 100). This parameter is essentially a computational
burden control parameter and should be increased to a larger value if
the final model has contexts that reach the maximum value (this is done
automatically in <code>tune_vlmc()</code>);</li>
<li><code>min_size</code>: the minimum number of occurrences of a
context in the time series for it to be included in the context tree
during the first phase of the algorithm. The default 2 value is very
conservative. Larger values will produce simpler trees;</li>
<li><code>alpha</code>/<code>cutoff</code>: this is the main complexity
control parameter, which can be expressed in two different scales.
<code>cutoff</code> is expressed in the native Kullback-Liebler
divergence scale used to assess the difference between conditional
probability distributions given different contexts. <code>alpha</code>
is expressed in a more convenient universal scale based on the quantiles
of the Chi-Squared distribution that appears when the pruning criterion
is interpreted as a likelihood ratio test (the default is
<code>alpha=0.05</code>).</li>
</ul>
<p>It is recommended to use the default value for <code>min_size</code>,
to increase <code>max_depth</code> only in case of “overflow” (i.e. when
the maximum context length reaches <code>max_depth</code>) and to use
only <code>alpha</code> to control the complexity of the VLMC,
preferably automatically with <code>tune_vlmc()</code>. An important
point to note is that a <em>higher</em> value of <code>alpha</code>
leads to a more complex model as does a <em>lower</em> value of
<code>cutoff</code>.</p>
<p>Based on theoretical results, the order of magnitude of
<code>cutoff</code> should be in <span class="math inline">\(K \log
n\)</span> (for <span class="math inline">\(n\)</span> observations),
where <span class="math inline">\(K\)</span> depends on the type of
convergence analysis conducted. For instance a BIC inspired value for
<span class="math inline">\(K\)</span> is <span class="math inline">\((|S|-1)/2\)</span> for a state space <span class="math inline">\(S\)</span> (of size <span class="math inline">\(|S|\)</span>). In the above example, we get:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>model_theo <span class="ot">&lt;-</span> <span class="fu">vlmc</span>(x, <span class="at">cutoff =</span> <span class="fu">log</span>(<span class="fu">length</span>(x)))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>model_theo</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; VLMC context tree on 0, 1, 2 </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;  cutoff: 5.298 (quantile: 0.005)</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;  Number of contexts: 0 </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;  Maximum context length: 0</span></span></code></pre></div>
<p>The result is a memory less model, as expected based on the way
<code>x</code> was generated. In this situation, the chosen value of
<code>cutoff</code> leads to the optimal model, but this is not always
the case as this choice is only informed by asymptotic analysis.</p>
</div>
<div id="model-choice" class="section level3">
<h3>Model choice</h3>
<p>In practice, it is recommended to start with a conservative value of
<code>cutoff</code> (or <code>alpha</code>) and to use a penalized
criterion to find the best model in a way that balances likelihood and
complexity. A conservative value of <code>cutoff</code> is a small one,
while <code>alpha</code> should be high to be conservative. A possible
choice is to use the BIC inspired <code>cutoff</code> divided by a fixed
value, for instance <span class="math inline">\(\frac{1}{4}(|S|-1)\log
n\)</span>.</p>
<p>Once a “large” model has been obtained, two functions can be used to
generate the collection of simpler models that would have been obtained
by using larger values of <code>cutoff</code>. The function
<code>cutoff()</code> returns a list of values (in <code>alpha</code>
scale by default) that are guaranteed to contain all values that can
generate simpler models that the reference one. For instance in the
following code</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>model_large <span class="ot">&lt;-</span> <span class="fu">vlmc</span>(x, <span class="at">cutoff =</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">length</span>(x)))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>model_large</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; VLMC context tree on 0, 1, 2 </span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt;  cutoff: 2.649 (quantile: 0.0707106781186548)</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;  Number of contexts: 6 </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;  Maximum context length: 3</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>model_cutoff <span class="ot">&lt;-</span> <span class="fu">cutoff</span>(model_large, <span class="at">mode =</span> <span class="st">&quot;native&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>model_cutoff</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; [1] 3.177898 3.784875</span></span></code></pre></div>
<p>we first adjust a “complex” model using `<code>cutoff=`2.65</code>
and find then that 2 other values can be used to build simpler models,
using <code>prune()</code> as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>model_medium <span class="ot">&lt;-</span> <span class="fu">prune</span>(model_large, <span class="at">cutoff =</span> model_cutoff[<span class="dv">1</span>])</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>model_medium</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; VLMC context tree on 0, 1, 2 </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;  cutoff: 3.178 (quantile: 0.0416731573600126)</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;  Number of contexts: 4 </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;  Maximum context length: 3</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>model_small <span class="ot">&lt;-</span> <span class="fu">prune</span>(model_large, <span class="at">cutoff =</span> model_cutoff[<span class="dv">2</span>])</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>model_small</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; VLMC context tree on 0, 1, 2 </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;  cutoff: 3.785 (quantile: 0.0227117061190262)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;  Number of contexts: 0 </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;  Maximum context length: 0</span></span></code></pre></div>
<p>The final model <code>model_small</code> is again the memory less
model.</p>
</div>
<div id="automatic-model-choice" class="section level3">
<h3>Automatic model choice</h3>
<p>The pair <code>cutoff()</code>/<code>prune()</code> can be used to
implement advanced model selection techniques, for instance based on the
quality of the predictions of the model on a hold-out example. For a
more standard use, the <code>tune_vlmc()</code> provides a fully
automated solution, including the choice of conservative values of the
initial cut off and of a large enough <code>max_depth</code>, as
demonstrated below:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>model_tune <span class="ot">&lt;-</span> <span class="fu">tune_vlmc</span>(x)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>model_opt <span class="ot">&lt;-</span> <span class="fu">as_vlmc</span>(model_tune)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>model_opt</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; VLMC context tree on 0, 1, 2 </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt;  cutoff: 3.785 (quantile: 0.0227117061190262)</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;  Number of contexts: 0 </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;  Maximum context length: 0</span></span></code></pre></div>
<p>We obtain directly an optimal model according to the BIC
criterion.</p>
</div>
<div id="model-choice-representation" class="section level3">
<h3>Model choice representation</h3>
<p>The object returned by <code>tune_vlmc()</code> contains a summary of
the fitting process. Let us consider a realistic example using the
<code>globalearthquake</code> data set included in the package. In this
simple example we extract from the data set the earth quakes that took
place within a 2,000 km radius around the <a href="https://en.wikipedia.org/wiki/List_of_geographic_centers_of_the_United_States">centre
of California</a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>California_centre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">longitude =</span> <span class="sc">-</span><span class="fl">119.449444</span>, <span class="at">latitude =</span> <span class="fl">37.166111</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">geodist</span>(globalearthquake[, <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>)],</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  California_centre,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">measure =</span> <span class="st">&quot;geodesic&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>California_earth_quakes <span class="ot">&lt;-</span> globalearthquake[distances <span class="sc">&lt;</span> <span class="fl">2e6</span>, ] <span class="do">## distances are in meters</span></span></code></pre></div>
<p>Then we study this collection at the week level, building a binary
sequence of weeks with or without earthquake(s).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>California_weeks <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">max</span>(globalearthquake<span class="sc">$</span>nbweeks))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>California_weeks[California_earth_quakes<span class="sc">$</span>nbweeks] <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div>
<p>And finally we adjust automatically a VLMC.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>California_weeks_earth_quakes_model <span class="ot">&lt;-</span> <span class="fu">tune_vlmc</span>(California_weeks)</span></code></pre></div>
<p>The resulting model remains relatively simple with an interesting
increase of the risk of observing an earth quake after 6 weeks after the
last one.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">draw</span>(<span class="fu">as_vlmc</span>(California_weeks_earth_quakes_model))</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; * (0.7988, 0.2012)</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; +-- 0 (0.8166, 0.1834)</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; |   +-- 0 (0.8268, 0.1732)</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; |   |   &#39;-- 0 (0.8332, 0.1668)</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; |   |       &#39;-- 0 (0.8398, 0.1602)</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; |   |           +-- 0 (0.8517, 0.1483)</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; |   |           |   &#39;-- 0 (0.8598, 0.1402)</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; |   |           |       &#39;-- 1 (0.7847, 0.2153)</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; |   |           &#39;-- 1 (0.7766, 0.2234)</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; |   &#39;-- 1 (0.771, 0.229)</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; &#39;-- 1 (0.7281, 0.2719)</span></span></code></pre></div>
<p>The tuning process can be summarised using the <code>summary()</code>
function as follows.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">summary</span>(California_weeks_earth_quakes_model)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; VLMC tune results</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; Best VLMC selected by BIC (6402.617)</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; VLMC context tree on 0, 1 </span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt;  cutoff: 5.679 (quantile: 0.000751559901684079)</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;  Number of contexts: 8 </span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt;  Maximum context length: 7 </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Pruning results</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt;     cutoff        alpha depth nb_contexts loglikelihood      AIC      BIC</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt;   2.191676 3.629154e-02    29         152     -2983.990 6271.980 7300.519</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt;   2.201782 3.586391e-02    29         139     -2997.384 6272.769 7213.341</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt;   2.228217 3.477002e-02    29         132     -3002.399 6268.798 7162.003</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt;   2.279152 3.275949e-02    29         132     -3002.399 6268.798 7162.003</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt;   2.339072 3.054872e-02    29         132     -3002.399 6268.798 7162.003</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt;   2.372521 2.938285e-02    29         132     -3002.399 6268.798 7162.003</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt;   2.381973 2.906186e-02    29         131     -3007.144 6276.288 7162.727</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt;   2.394852 2.863036e-02    29         130     -3010.365 6280.730 7160.402</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt;   2.404277 2.831881e-02    29         127     -3013.768 6281.535 7140.907</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt;   2.416055 2.793443e-02    29         116     -3021.089 6274.179 7059.117</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt;   2.445039 2.701147e-02    29         114     -3026.248 6280.495 7051.900</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt;   2.506516 2.515721e-02    29         110     -3033.433 6286.866 7031.203</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt;   2.577905 2.316872e-02    29         110     -3033.433 6286.866 7031.203</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt;   2.625968 2.192238e-02    29         108     -3036.860 6289.719 7020.523</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt;   2.751151 1.899146e-02    29         103     -3040.986 6287.972 6984.942</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt;   2.893754 1.614045e-02    29         103     -3040.986 6287.972 6984.942</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt;   3.125676 1.240985e-02    29         103     -3041.203 6288.406 6985.377</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt;   3.344228 9.703925e-03    29          95     -3049.898 6289.795 6932.632</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt;   3.417970 8.934162e-03    27          90     -3056.377 6292.754 6901.758</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt;   3.536173 7.828270e-03    27          87     -3061.796 6297.593 6886.296</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt;   3.737381 6.256985e-03    27          63     -3082.299 6290.599 6716.901</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt;   4.077262 4.295389e-03    27          45     -3104.913 6299.826 6604.328</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt;   4.382147 3.071849e-03    27          43     -3110.517 6307.033 6598.002</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt;   4.507405 2.678006e-03    10          26     -3129.277 6310.554 6486.489</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt;   4.628051 2.347121e-03    10          21     -3138.370 6318.739 6460.840</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt;   4.763629 2.024423e-03    10          14     -3149.107 6326.214 6420.948</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt;   5.090995 1.418191e-03     7          11     -3156.238 6334.476 6408.910</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt;   5.678601 7.515599e-04     7           8     -3166.241 6348.483 6402.617</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt;   6.040782 5.092285e-04     5           6     -3176.888 6365.776 6406.377</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt;   6.183282 4.370913e-04     5           6     -3177.148 6366.296 6406.896</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a><span class="co">#&gt;  10.764714 3.484403e-06     1           2     -3197.821 6399.643 6413.176</span></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co">#&gt;  26.426030 3.596414e-13     0           0     -3221.590 6443.180 6443.180</span></span></code></pre></div>
<p>in addition, a summary data frame is accessible in the
<code>results</code> component of the object. This can be used to build
e.g. graphical representation of the model selection process for
instance as follows</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(California_weeks_earth_quakes_model<span class="sc">$</span>results, <span class="fu">aes</span>(<span class="at">x =</span> alpha, <span class="at">y =</span> BIC)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="diagnostics" class="section level3">
<h3>Diagnostics</h3>
<p>The package provides numerous ways to analyse a VLMC. Basic functions
include</p>
<ul>
<li><code>states()</code> returns the state space of the model;</li>
<li><code>depth()</code> returns the length of the longest context in
the model;</li>
<li><code>context_number()</code> returns the number of contexts in the
model.</li>
</ul>
<p>For instance, the large model obtained above has the following
characteristics:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">states</span>(model_large)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; [1] 0 1 2</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">depth</span>(model_large)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">context_number</span>(model_large)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>VLMC objects support classical statistical functions such as:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">logLik</span>(model_large)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; &#39;log Lik.&#39; -206.1223 (df=12)</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">AIC</span>(model_large)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; [1] 436.2446</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">BIC</span>(model_large)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; [1] 475.8244</span></span></code></pre></div>
</div>
<div id="contexts" class="section level3">
<h3>Contexts</h3>
<p>The model can be explored in details by drawing its context tree (see
<code>vignette(&quot;context-trees&quot;)</code> for details) as follows:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">draw</span>(model_large)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; * (0.325, 0.345, 0.33)</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; &#39;-- 1 (0.3043, 0.4203, 0.2754)</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt;     +-- 1 (0.2069, 0.4828, 0.3103)</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt;     |   &#39;-- 0 (0.2222, 0.7778, 0)</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt;     &#39;-- 2 (0.3, 0.3, 0.4)</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt;         &#39;-- 2 (0, 0.375, 0.625)</span></span></code></pre></div>
<p>To explore the contexts in a programmatic way, one should rely on the
<code>contexts()</code> function. VLMC contexts have additional
characteristics compared to context trees. In particular, the
<code>contexts()</code> function can report the log likelihood ratio
associated to each context as follows (compare to <code>cutoff()</code>
above):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">contexts</span>(model_large, <span class="at">cutoff =</span> <span class="st">&quot;native&quot;</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">context</th>
<th align="right">cutoff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1, 1, 0</td>
<td align="right">3.4813864</td>
</tr>
<tr class="even">
<td align="left">1, 1</td>
<td align="right">0.7006631</td>
</tr>
<tr class="odd">
<td align="left">1, 2, 2</td>
<td align="right">2.9008662</td>
</tr>
<tr class="even">
<td align="left">1, 2</td>
<td align="right">0.8777091</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">0.9067789</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<p>Notice that by default <code>contexts()</code> uses the reverse
representation of contexts, but they can be returned in the natural time
sequence using <code>reverse=FALSE</code>, as in</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">contexts</span>(model_large, <span class="at">cutoff =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">reverse =</span> <span class="cn">FALSE</span>, <span class="at">frequency =</span> <span class="st">&quot;detailed&quot;</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">context</th>
<th align="right">freq</th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">cutoff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0, 1, 1</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">0.0307647</td>
</tr>
<tr class="even">
<td align="left">1, 1</td>
<td align="right">29</td>
<td align="right">6</td>
<td align="right">14</td>
<td align="right">9</td>
<td align="right">0.4962561</td>
</tr>
<tr class="odd">
<td align="left">2, 2, 1</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">0.0549756</td>
</tr>
<tr class="even">
<td align="left">2, 1</td>
<td align="right">20</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">8</td>
<td align="right">0.4157342</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">69</td>
<td align="right">21</td>
<td align="right">29</td>
<td align="right">19</td>
<td align="right">0.4038229</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="right">200</td>
<td align="right">65</td>
<td align="right">69</td>
<td align="right">66</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
